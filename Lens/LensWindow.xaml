<Window x:Class="SelectUnknown.LensWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SelectUnknown" xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        
        WindowStyle="None"
        AllowsTransparency="True"
        WindowState="Maximized"
        ResizeMode="NoResize"
        Topmost="True"
        Background="Transparent"
        KeyDown="Window_KeyDown"
        Loaded="Window_Loaded"
        ShowInTaskbar="False"
        
        Title="Select Unknown" Height="1080" Width="1920">
    <Grid Name="MainGrid">
        <Image x:Name="ScreenImage" Stretch="UniformToFill"/>
        <Image x:Name="BackgroundImage" Opacity="0.0" Stretch="UniformToFill" IsHitTestVisible="False" Source="pack://siteoforigin:,,,/res/background.png"/>
        
        <Canvas Name="SelectionCanvas" Cursor="Cross">
            <Rectangle Name="SelectionRectangle" Stroke="#7F3399FF" StrokeThickness="2" Fill="Transparent" Visibility="Hidden"/>
            <Canvas.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="3" Direction="270" Opacity="0.5" Color="#E89ABD"/>
            </Canvas.Effect>
        </Canvas>
        
        <Border GotFocus="ToolBox_GotFocus" Name="ToolBox" Background="#FFBFD9DC" Height="45" Width="300" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="12" CornerRadius="15">
            <Grid Margin="15,0">
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,0">
                    <Border Width="30" Height="45" Background="Transparent" Cursor="SizeAll" MouseLeftButtonDown="Border_MouseLeftButtonDown" MouseLeftButtonUp="Border_MouseLeftButtonUp" MouseMove="Border_MouseMove" VerticalAlignment="Center">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Rectangle Width="18" Height="4" Fill="#FFB0B0B0" RadiusX="2" RadiusY="2" Margin="0,4"/>
                            <Rectangle Width="18" Height="4" Fill="#FFB0B0B0" RadiusX="2" RadiusY="2" Margin="0,4"/>
                            <Rectangle Width="18" Height="4" Fill="#FFB0B0B0" RadiusX="2" RadiusY="2" Margin="0,4"/>
                        </StackPanel>
                    </Border>
                    <!--框选工具-->
                    <Button Name="SelectRectangle" Click="SelectRectangle_Click" ToolTip="矩形选区" Style="{DynamicResource MaterialDesignFloatingActionButton}" Margin="0,2,2,2" Width="25" Height="25">
                        <materialDesign:PackIcon Kind="ButtonCursor" Foreground="#FF292929"/>
                    </Button>
                    
                    <materialDesign:PackIcon Kind="DragVerticalVariant" Foreground="#FFA9C0C3" VerticalAlignment="Center"/>
                    
                    <!--截图工具-->
                    

                    <Button Name="TakeColor" Click="TakeColor_Click" ToolTip="取色工具" Background="#FFE89ABD" BorderBrush="#FFE89ABD" Style="{DynamicResource MaterialDesignFloatingActionButton}" Margin="2,2,2,2" Width="25" Height="25">
                        <materialDesign:PackIcon Kind="Eyedropper" Foreground="#FF292929"/>
                    </Button>
                    <Button Name="SaveScreen" Click="SaveScreen_Click" ToolTip="保存整个屏幕" Background="#FFE89ABD" BorderBrush="#FFE89ABD" Style="{DynamicResource MaterialDesignFloatingActionButton}" Margin="8,2,2,2" Width="25" Height="25">
                        <materialDesign:PackIcon Kind="ContentSave" Foreground="#FF292929"/>
                    </Button>

                    <materialDesign:PackIcon Kind="DragVerticalVariant" Foreground="#FFA9C0C3" VerticalAlignment="Center"/>
                    <Button Name="HideBackground" Click="HideBackground_Click" ToolTip="隐藏彩雾 (Back)" Background="#FF31D051" BorderBrush="#FF31D051" Style="{DynamicResource MaterialDesignFloatingActionButton}" Margin="2,2,2,2" Width="25" Height="25">
                        <materialDesign:PackIcon Name="HideBackgroundIcon" Kind="Hide" Foreground="#FF292929"/>
                    </Button>
                    <Button Name="Settings" Click="Settings_Click" ToolTip="设置" Background="#FF31D051" BorderBrush="#FF31D051" Style="{DynamicResource MaterialDesignFloatingActionButton}" Margin="8,2,2,2" Width="25" Height="25">
                        <materialDesign:PackIcon Kind="Settings" Foreground="#FF292929"/>
                    </Button>
                    <materialDesign:PackIcon Kind="DragVerticalVariant" Foreground="#FFA9C0C3" VerticalAlignment="Center"/>
                    <Button Name="Close" Click="Close_Click" ToolTip="关闭 (Esc)" Background="#FFDE4B4B" BorderBrush="#FFDE4B4B" Style="{DynamicResource MaterialDesignFloatingActionButton}" Margin="2,2,2,2" Width="25" Height="25">
                        <materialDesign:PackIcon Kind="Close" Foreground="#FF292929"/>
                    </Button>
                </StackPanel>
                
            </Grid>
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="3" Direction="270" Opacity="0.5" Color="Black"/>
            </Border.Effect>
            <Border.RenderTransform>
                <TranslateTransform x:Name="dragTransform"/>
            </Border.RenderTransform>
            
        </Border>

        <Grid GotFocus="Browser_GotFocus" Name="Browser" Background="Transparent" Width="450" Height="800" HorizontalAlignment="Right" Margin="0,0,25,0">
            <Border Background="AliceBlue" CornerRadius="20">
                <Grid>
                    <StackPanel Height="60" VerticalAlignment="Top" Orientation="Horizontal">
                        <!--拖拽-->
                        <Border Background="AliceBlue" Cursor="SizeAll" Width="15" Margin="15,12,0,6" MouseDown="Border_MouseDown" MouseMove="Border_MouseMove_1" MouseUp="Border_MouseUp">
                            <materialDesign:PackIcon Kind="Drag" VerticalAlignment="Center"/>
                        </Border>

                        <TextBox x:Name="AddressBar" ToolTip="浏览器中打开" Height="30" Width="280" Margin="8,6,15,0" Text="{Binding ElementName=webView, Path=Source}" AcceptsReturn="False" IsReadOnly="True" VerticalAlignment="Center"/>
                        <Button x:Name="ShowInBrowser" Style="{DynamicResource MaterialDesignFloatingActionButton}" Width="40" Height="40" Margin="0,6,0,0" Click="ShowInBrowser_Click" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="OpenInNew" Foreground="AliceBlue"/>
                        </Button>
                        <Button x:Name="Minisize" ToolTip="最小化" Style="{DynamicResource MaterialDesignFloatingActionButton}" Width="40" Height="40" Margin="15,6,0,0" Click="Minisize_Click" VerticalAlignment="Center">
                            <materialDesign:PackIcon Kind="WindowMinimize" Foreground="AliceBlue"/>
                        </Button>
                    </StackPanel>
                    <ProgressBar x:Name="Loading" Height="5" Width="280" HorizontalAlignment="Left" Margin="38,50,0,0" VerticalAlignment="Top" IsIndeterminate="True"></ProgressBar>


                    <Border x:Name="WebView" BorderBrush="AliceBlue" Margin="15,60,15,15">
                        <wv2:WebView2 x:Name="webView" Source="https://google.com/" NavigationCompleted="webView_NavigationCompleted" NavigationStarting="webView_NavigationStarting"></wv2:WebView2>
                    </Border>
                </Grid>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="3" Direction="270" Opacity="0.5" Color="Black"/>
                </Border.Effect>
            </Border>

            <Grid.RenderTransform>
                <TranslateTransform x:Name="BrowserDragTransform" />
            </Grid.RenderTransform>
            
        </Grid>
        <Grid GotFocus="TextProcess_GotFocus" x:Name="TextProcess" Width="350" Height="190" HorizontalAlignment="Left" Margin="25,0,0,0">
            <Border Background="#F4E5D9" CornerRadius="15">
                <Grid>
                    <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Top" Margin="8">
                        <!--拖拽-->
                        <Border Background="#F4E5D9" Cursor="SizeAll" Width="15" Margin="0" MouseDown="Border_MouseDown_1" MouseMove="Border_MouseMove_2" MouseUp="Border_MouseUp_1">
                            <materialDesign:PackIcon Kind="Drag" VerticalAlignment="Center"/>
                        </Border>
                    </StackPanel>
                    <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="8">
                        <Button x:Name="Translate" ToolTip="翻译选定文本（未选定则翻译全部）" Style="{DynamicResource MaterialDesignFloatingActionButton}" Background="#BBA08C" BorderBrush="#BBA08C" Width="25" Height="25" Margin="15,0,0,0" Click="Translate_Click" VerticalAlignment="Center" HorizontalAlignment="Right">
                            <materialDesign:PackIcon Kind="Translate" Foreground="AliceBlue"/>
                        </Button>
                        <Button x:Name="CopyAllText" ToolTip="复制所有文本" Style="{DynamicResource MaterialDesignFloatingActionButton}" Background="#BBA08C" BorderBrush="#BBA08C" Width="25" Height="25" Margin="15,0,0,0" Click="CopyAllText_Click" VerticalAlignment="Center" HorizontalAlignment="Right">
                            <materialDesign:PackIcon Kind="ContentCopy" Foreground="AliceBlue"/>
                        </Button>
                        <Button x:Name="SearchSelectedText" ToolTip="搜索选定文本（未选定则搜索全部）" Style="{DynamicResource MaterialDesignFloatingActionButton}" Background="#BBA08C" BorderBrush="#BBA08C" Width="25" Height="25" Margin="15,0,0,0" Click="SearchSelectedText_Click" VerticalAlignment="Center" HorizontalAlignment="Right">
                            <materialDesign:PackIcon Kind="Search" Foreground="AliceBlue"/>
                        </Button>
                    </StackPanel>
                    <TextBox Name="MainText" LostFocus="MainText_LostFocus" FontSize="16" HorizontalContentAlignment="Left" Grid.Row="1" Margin="8" AcceptsReturn="True" TextWrapping="Wrap"></TextBox>
                    <ProgressBar x:Name="TextProcessLoading" Height="4" Width="280" HorizontalAlignment="Left" Margin="38,41,0,0" VerticalAlignment="Top" Background="#FFE6C7B0" BorderBrush="#FFE6C7B0" Foreground="#FFBBA08C" IsIndeterminate="True" Visibility="Hidden"></ProgressBar>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                    </Grid.RowDefinitions>
                </Grid>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="3" Direction="270" Opacity="0.5" Color="Black"/>
                </Border.Effect>
            </Border>
            <Grid.RenderTransform>
                <TranslateTransform x:Name="TextProcessDragTransform"></TranslateTransform>
            </Grid.RenderTransform>
        </Grid>
    </Grid>
</Window>
